\documentclass[11pt]{article}
\usepackage{geometry}                % See geometry.pdf to learn the layout options. There are lots.
\geometry{a4paper}
\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{epstopdf}
\usepackage{multirow}
\DeclareGraphicsRule{.tif}{png}{.png}{`convert #1 `dirname #1`/`basename #1 .tif`.png}
\usepackage{hyperref}

\newcommand{\ciftocell}{\texttt{cif2cell}}

\newenvironment{warning}[1][Warning!]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}


\title{The \ciftocell{} manual}
\author{Torbj\"orn Bj\"orkman}
%\date{}                                           % Activate to display a given date or no date

\begin{document}
\maketitle
\section*{Introduction -- Of CIF's and Cells}
An electronic structure program needs atomic positions and, at least in the case of band structure programs, unit cell vectors to calculate the electronic structure of a crystal. Experimental data on the other hand tends to be given as a space group and a set of irreducible, or wyckoff positions, and are often distributed in the form of CIF files. There is a wide range of sources of CIF files -- it is actually used for communication of crystallographic data by virtually everyone outside of the electronic structure community! Yet far from all electronic structure programs can read the CIF format, and from this circumstance a small set of my convenience scripts one day turned into the program \ciftocell.

What the program does is simply to take the crystal structure information in a CIF file, typically space group information and a set of irreducible coordinates, and then set up a calculation cell which is then output to your favourite electronic structure program (ESP). As you are probably aware, the choice of calculation cell for a given crystal is arbitrary and infinitely many possibilities exist for any given crystal. Perhaps the simplest example is when a problem require us to set up a supercell, which is just describing the same crystal in a different cell than the primitive one, but even the primitive cell can often be chosen in many different ways. \ciftocell{} contains working solutions for choices of primitive cells for (almost) any possible crystal and will make a choice automatically. You may choose either the primitive cell for the given structure, such as the rhombohedral cell with one atom for fcc Cu, or the conventional cell, a cubic cell with four atoms for fcc Cu. These cells can then be used as building blocks for generating supercells by multiplying them up and/or inputting extra vacuum in the structure. 

This manual is intended as a document for computational physicists and materials scientists. The problems that you solve when generating a computational cell from crystallographic data belongs to the field of crystallography and the program is not intended to replace a working knowledge of basic crystallography. Remember this, and refer to your textbook in crystallography or solid state physics/chemistry when you get confused and your life with \ciftocell{} will be happy.

The code was published in \href{http://dx.doi.org/10.1016/j.cpc.2011.01.013}{Computer Physics Communications {\bf 182}, 1183--1186 (2011)}, please cite generously. Happy computing!

\newpage
\section{Installation}
\subsection{Requirements}
\ciftocell{} requires Python 2.4 or higher and the PyCIFRW python package\footnote{Available from \texttt{http://pycifrw.berlios.de}.}. Note however that the output may be slightly different (but equivalent) with Python 2.4 than with later versions due to differences in the internal sorting routines of different Python distributions.

To install the program in your systems standard location, type:
\begin{verbatim}
python setup.py install 
\end{verbatim}
To choose a different location, add 
\begin{verbatim}
--prefix=where/you/want/it 
\end{verbatim}
to the above line. For help and more options type
\begin{verbatim}
python setup.py --help
\end{verbatim}


\section{Getting started}

This section is meant to give you a quick overview of how you generate cells to get you started as quickly as possible. Running \ciftocell{} is quick, so the best way to learning to work with it is to simply run it over and over, testing different settings and options until you have what you want. The program comes with a small set of sample CIF files which can be found either in the source distribution or in the directory \texttt{[prefix]/lib/cif2cell/sample\_cifs}, where \texttt{[prefix]} is the path where you installed \ciftocell. The examples below assume that you stand in a directory containing these sample files. In the following, some arbitrary command line input will be specified within brackets \texttt{[like this]}. 

\subsection{Help!}
The quickest way to get help in \ciftocell{} is to type
\begin{verbatim}
cif2cell -h
\end{verbatim}
This will list all available input options along with a description.

\subsection{The first run}\label{firstrun}
There is only one required piece of input, and that is the CIF file itself which is given either as the first argument to the program:
\begin{verbatim}
cif2cell Si.cif [options]
\end{verbatim}
or anywhere in the argument list with the \texttt{-f} flag:
\begin{verbatim}
cif2cell [someoptions] -f Si.cif [otheroptions]
\end{verbatim}
and if no output program is specified, the cell information is output to screen:

\begin{verbatim}
CIF2CELL 0.4.0
2011-03-25 16:35
Output for Si (Silicon)
CIF file exported from Inorganic Crystal Structure Database.
Database reference code: 51688.

 BIBLIOGRAPHIC INFORMATION
Toebbens, D.M. et al., Materials Science Forum 378, 288-293 (2001) 

 SYMMETRY INFORMATION
Cubic crystal system.
Space group number     : 227
Hall symbol            : F 4d 2 3 -1d
Hermann-Mauguin symbol : Fd-3mS

 INPUT CELL INFORMATION
Lattice parameters:
          a           b           c 
  5.4305300   5.4305300   5.4305300 
      alpha        beta       gamma 
 90.0000000  90.0000000  90.0000000 
Representative sites :
Atom           a1          a2          a3 
Si      0.0000000   0.0000000   0.0000000

 OUTPUT CELL INFORMATION
Bravais lattice vectors :
  0.5000000   0.5000000   0.0000000 
  0.5000000   0.0000000   0.5000000 
  0.0000000   0.5000000   0.5000000 
All sites, (lattice coordinates):
Atom           a1          a2          a3 
Si      0.0000000   0.0000000   0.0000000
Si      0.2500000   0.2500000   0.2500000
\end{verbatim}

\newpage
First there is some information about the program itself and a description of the compound derived from information in the CIF file. If the file comes from a databases known to \ciftocell, information about that is also printed. Then follows any bibliographic information found in the file. Then starts the actual crystal information with data about the space group. If the \texttt{-v} or \texttt{--print-symmetry-operations} flags are given, all symmetry operations will also be printed here. Next comes the lattice parameters and representative sites (occupied wyckoff positions), with the the chemical elements and, in case of an alloy, another column with the site occupancies. Then follows the things we actually want -- the Bravais lattice vectors and all positions of the atoms.  In the case of Si in the diamond structure the result is probably familiar:  the standard fcc lattice vectors and two atoms in the basis, one at $(0,0,0)$ and another in $(\frac{1}{4},\frac{1}{4},\frac{1}{4})$. 

Having generated the basic cell we want to export that to our favourite ESP. This is done by simply giving the option \texttt{-p espname} or \texttt{--program=espname}. The possible choices for \texttt{espname} can be found in Table \ref{esptable}, where you also find what files will be generated. Let's try this out for someones favourite program VASP. Adding the option \texttt{-p vasp} you will get the above output, properly formatted, to a file called POSCAR:
\begin{verbatim}
Generated by cif2cell 0.4.6 from [...] Species order: Si 
   5.430530
  0.500000000000000   0.500000000000000   0.000000000000000
  0.500000000000000   0.000000000000000   0.500000000000000
  0.000000000000000   0.500000000000000   0.500000000000000
   2
Direct
  0.000000000000000   0.000000000000000   0.000000000000000 
  0.250000000000000   0.250000000000000   0.250000000000000 
\end{verbatim}
Notice that the very long first line containing a lot of information about where the data came from is shortened here (marked by \texttt{[...]}). The important thing to see is that we get a correct output file, and that \ciftocell{} helps you keep track of where the data came from, to the extent that this can be inferred from the CIF file. The last bit of the line,  "Species order: Si", is important. It tells you which the atomic species are that are part of the file, since, in the particular case of VASP, this information is not given here, but in a different file, POTCAR, which was not generated by \ciftocell{}. To enable the user to set up the POTCAR file properly, \ciftocell{} stored the information needed here, but other ways of handling this information are also available, study the ESP specific output options to find out how.

\section{Getting further}

\subsection{Cell generation}
By default, \ciftocell{} will reduce the cell to the primitive cell, anticipating that the user wants to calculate something as small as possible, but we can also get the conventional cell. The diamond structure is a cubic system, and the primitive cell has only two atoms. Now try to also give the program the option \texttt{--no-reduce}. You should now get 8 atoms and cubic lattice vectors. Note that the conventional and primitive cell are the same in many systems.\footnote{In all systems which has a space group, or Hermann-Mauguin (H-M), symbol that starts with ''P'' (for ''primitive''). See the example for fcc Si above, where the H-M symbol is 'F', (from German ''Fl\"achenzentriert'', meaning face-centered).}
For the fcc lattice the choice of primitive lattice vectors is straightforward, but in many systems of lower symmetry, in particular monoclinic systems, the choice is not always as simple. \ciftocell{} has default choices for the Bravais lattice vectors that were selected to produce calculation cells similar to those listed at the Naval Research Laboratory site \href{http://cst-www.nrl.navy.mil/lattice/}{\texttt{http://cst-www.nrl.navy.mil/lattice/}.}


\subsection{Output}

In section \ref{firstrun}, output for VASP was generated to the default file POSCAR. You may also decide the output file name yourself by giving the option \texttt{-o outputfilename} or \texttt{--outputfile=outputfilename}. If you wish to append the output from \ciftocell{} at the end of some existing file, give the option \texttt{-a} or \texttt{--append}, but note that this requires that you also specify the output file name. Appending to existing files is useful for example if you have a template file with your magic settings and just wish to add the cell with the atoms. You will notice that for nearly all ESP's, \ciftocell{} generates \emph{only} the geometric part of the setup, unless you specify the \texttt{--setup-all} flag, which not supported for many ESP's right now. 

Generation of cells for alloy theory calculations is possible for ESP's that implement such features. For other ESP's, you may use the \texttt{--force-alloy} option to generate as much of the geometric input as possible. 
\begin{warning}
Output files generated with \texttt{--force-alloy} \emph{always} need further editing. The partially occupied sites will get some placeholder string where the element should be specified, no attempt is made by \ciftocell{} to guess what you want to do.
\end{warning}
 The supported ESP's can be found in Table \ref{esptable}, where you also find what files will be generated and whether they support full output generation and alloy theory.
 
\begin{table}[htdp]
\caption{Supported electronic structure programs (ESP) and the files output by \ciftocell. Also shown is whether the ESP implements some alloy theory and whether \ciftocell{} currently supports full output.}
\begin{center}
\begin{tabular}{l|c|c|c}
ESP  & Alloy support & Full setup & Output file(s)\\ \hline
\href{http://www.abinit.org/}{ABINIT} & no & no & [compoundname].in\\
\href{http://www.castep.org/}{CASTEP} & no & no & [compoundname].cell\\
\href{http://www.fplmto-rspt.org/}{cellgen} & no & no & cellgen.inp\\
\href{http://www.cpmd.org}{CPMD} & no & no & [compoundname].inp\\
\href{http://www.crystal.unito.it/}{Crystal09} & no & no & [compoundname].d12\\
\href{http://www.flapw.de}{Fleur} & no & no & inp\_[compoundname]\\
\href{http://www.fplmto-rspt.org/}{RSPt} & no & no & symt.inp\\
\href{http://elk.sourceforge.net}{Elk} & no & no & GEOMETRY.OUT\\
\multirow{3}{*}{EMTO} & & & [spacegroupname/compoundname].dat \\ 
 & yes & no & for kstr, bmdl, shape, kgrn and kfcd \\
 &  & & in separate directories.\\
\href{http://exciting-code.org}{Exciting} & no & no & input.xml\\
\multirow{2}{*}{ncol} & no & no & [spacegroupname/compoundname].dat \\
 &  &  & for bstr and ncol. \\
\href{http://www.icmab.es/dmmis/leem/siesta/}{Siesta} & no & no & [compoundname].fdf\\
\href{http://elk.sourceforge.net}{Spacegroup} & no & no & spacegroup.in\\
\href{http://ebert.cup.uni-muenchen.de/sprkkr}{SPRKKR} & yes & no & [compoundname].sys (via XBAND) \\
\href{http://www.vasp.at/}{VASP} & no  & yes & POSCAR \\
\href{http://ebert.cup.uni-muenchen.de/sprkkr}{XBAND} & yes & no & [compoundname].sys\\
\end{tabular}
\end{center}
\label{esptable}
\end{table}%


\end{document}  